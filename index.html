<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç­çº§è¯¾ç¨‹è¡¨ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="to.css">
    <style>
        /* æ–°å¢å¯†ç ä¿æŠ¤æ ·å¼ */
        #passwordProtect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            backdrop-filter: blur(5px);
            z-index: 9999;
            display: none;
            justify-content: center;
            align-items: center;
            color: white;
        }
        .password-container {
            background: #222;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            width: 300px;
            max-width: 90%;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        .shake {
            animation: shake 0.5s;
        }
    </style>
</head>
<body id="pageBody">
    <!-- å¯†ç ä¿æŠ¤å¼¹çª— -->
    <div id="passwordProtect">
        <div class="password-container">
            <h2 style="margin-top:0;color:#4CAF50;">ç­çº§ä¸“å±è®¿é—®</h2>
            <div style="margin:20px 0;">
                <input type="password" id="sitePassword" placeholder="è¾“å…¥è®¿é—®å¯†ç " 
                    style="padding:10px;width:100%;box-sizing:border-box;border:2px solid #4CAF50;border-radius:4px;font-size:16px;">
                <p id="passwordError" style="color:red;display:none;margin:5px 0 0 0;">âœ– å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•</p>
            </div>
            <button onclick="checkSitePassword()" 
                    style="padding:10px 20px;background:#4CAF50;color:white;border:none;border-radius:4px;cursor:pointer;font-weight:bold;width:100%;">
                è¿›å…¥ç³»ç»Ÿ
            </button>
        </div>
    </div>
    
    <div class="container">
        <h1>ç­çº§è¯¾ç¨‹è¡¨ç®¡ç†ç³»ç»Ÿ <span id="editIndicator" class="edit-mode-indicator" style="display:none;">ç¼–è¾‘æ¨¡å¼</span></h1>
        
        <div class="week-navigation" id="weekNavigation">
            <button onclick="timetable.prevWeek()" class="btn-secondary">ä¸Šä¸€å‘¨</button>
            <span id="currentWeekDisplay">ç¬¬1å‘¨</span>
            <button onclick="timetable.nextWeek()" class="btn-secondary">ä¸‹ä¸€å‘¨</button>
        </div>
        
        <div class="auth-panel" id="authPanel">
            <h3>è¯·é€‰æ‹©è®¿é—®æ¨¡å¼</h3>
            <button onclick="timetable.setViewMode('student')" class="btn-primary">å­¦ç”ŸæŸ¥çœ‹æ¨¡å¼</button>
            <button onclick="timetable.showTeacherLogin()" class="btn-primary">æ•™å¸ˆç¼–è¾‘æ¨¡å¼</button>
            <div id="teacherLogin" style="display:none; margin-top:15px;">
                <div class="form-group password-input">
                    <label for="teacherPassword">æ•™å¸ˆå¯†ç </label>
                    <input type="password" id="teacherPassword" placeholder="è¯·è¾“å…¥æ•™å¸ˆå¯†ç ">
                    <span class="toggle-password" onclick="timetable.togglePasswordVisibility()">ğŸ‘ï¸</span>
                </div>
                <button onclick="timetable.checkTeacherPassword()" class="btn-primary">ç¡®è®¤</button>
                <div id="passwordError" style="color:red; margin-top:10px; display:none;">å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ï¼</div>
            </div>
        </div>
        
        <div class="bg-controls" id="bgControls" style="display:none;">
            <h3>èƒŒæ™¯è®¾ç½®</h3>
            <div class="form-group">
                <label for="bgImageUrl">èƒŒæ™¯å›¾ç‰‡URL</label>
                <input type="text" id="bgImageUrl" placeholder="è¾“å…¥å›¾ç‰‡é“¾æ¥">
            </div>
            <button onclick="timetable.changeBackground()" class="btn-secondary">åº”ç”¨èƒŒæ™¯</button>
            <button onclick="timetable.resetBackground()" class="btn-secondary">é‡ç½®èƒŒæ™¯</button>
        </div>
        
        <div class="timetable-controls" id="timetableControls" style="display:none;">
            <button onclick="timetable.showAddCourseModal()" class="btn-primary">æ·»åŠ è¯¾ç¨‹(å®é™…ä¸ŠæŒ‰ä¸åŠ¨ï¼Œç‚¹è¯¾ç¨‹è¡¨æ ¼å­èƒ½ç›´æ¥ç¼–è¾‘)</button>
            <button onclick="timetable.saveTimetable()" class="btn-primary">ä¿å­˜è¯¾ç¨‹è¡¨</button>
            <button onclick="timetable.setViewMode('student')" class="btn-secondary">é€€å‡ºç¼–è¾‘æ¨¡å¼</button>
        </div>
        
        <table class="timetable" id="timetable">
            <thead>
                <tr>
                    <th>æ—¶é—´</th>
                    <th>å‘¨ä¸€</th>
                    <th>å‘¨äºŒ</th>
                    <th>å‘¨ä¸‰</th>
                    <th>å‘¨å››</th>
                    <th>å‘¨äº”</th>
                    <th>å‘¨å…­</th>
                    <th>å‘¨æ—¥</th>
                </tr>
            </thead>
            <tbody>
                <!-- æ—¶é—´è¡Œä¼šé€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </tbody>
        </table>
        
        <!-- è¯¾ç¨‹ç¼–è¾‘æ¨¡æ€æ¡† -->
        <div class="modal" id="courseModal">
            <div class="modal-content">
                <h3 id="modalTitle">æ·»åŠ è¯¾ç¨‹</h3>
                <div class="form-group">
                    <label for="modalCourseName">è¯¾ç¨‹åç§°</label>
                    <input type="text" id="modalCourseName" placeholder="ä¾‹å¦‚: æ•°å­¦">
                </div>
                <div class="form-group">
                    <label for="modalTeacher">æ•™å¸ˆ</label>
                    <input type="text" id="modalTeacher" placeholder="ä¾‹å¦‚: å¼ è€å¸ˆ">
                </div>
                <div class="form-group">
                    <label for="modalClassroom">æ•™å®¤</label>
                    <input type="text" id="modalClassroom" placeholder="ä¾‹å¦‚: 301æ•™å®¤">
                </div>
                <div class="form-group">
                    <label for="modalColor">è¯¾ç¨‹é¢œè‰²</label>
                    <input type="color" id="modalColor" value="#4CAF50">
                </div>
                <div class="button-group">
                    <button onclick="timetable.saveCourse()" class="btn-primary" id="saveCourseBtn">ä¿å­˜</button>
                    <button onclick="timetable.deleteCourse()" class="btn-danger" id="deleteCourseBtn" style="display:none;">åˆ é™¤</button>
                    <button onclick="timetable.closeModal()" class="btn-secondary">å–æ¶ˆ</button>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Â© 2025 ç­çº§è¯¾ç¨‹è¡¨ç®¡ç†ç³»ç»Ÿ - made by SL</p>
            <div class="creator-info">
                <img src="https://raw.githubusercontent.com/USER-LOCAL/USER-LOCAL.github.io/main/images/sl-summer.png" alt="å¼€å‘è€…å¤´åƒ" class="creator-avatar" id="creatorAvatar">
                <a href="https://space.bilibili.com/3546599114410457" target="_blank" style="color:#fb7299; text-decoration:none;">
                    å¼€å‘è€…çš„Bç«™ä¸»é¡µ
                </a>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // åˆå§‹åŒ–å¯†ç æ£€æŸ¥
        document.addEventListener('DOMContentLoaded', function() {
            if(localStorage.getItem('siteAuth') === 'true') {
                document.getElementById('passwordProtect').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
                timetable.init();
            } else {
                document.getElementById('passwordProtect').style.display = 'flex';
                document.getElementById('sitePassword').focus();
            }
        });
        
        // å…¨å±€éªŒè¯å‡½æ•°
        window.checkSitePassword = function() {
            const password = "2303"; // è®¾ç½®ä½ çš„å¯†ç 
            const input = document.getElementById('sitePassword').value;
            
            if(input === password) {
                localStorage.setItem('siteAuth', 'true');
                document.getElementById('passwordProtect').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
                timetable.init();
            } else {
                document.getElementById('passwordError').style.display = 'block';
                document.getElementById('sitePassword').classList.add('shake');
                setTimeout(() => {
                    document.getElementById('sitePassword').classList.remove('shake');
                }, 500);
            }
        }
        
        // å›è½¦é”®æ”¯æŒ
        document.getElementById('sitePassword').addEventListener('keypress', function(e) {
            if(e.key === 'Enter') checkSitePassword();
        });
    </script>
</body>
</html>
